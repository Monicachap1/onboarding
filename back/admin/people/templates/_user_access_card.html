{% load i18n %}
<div class="card">
  <div class="card-header">
    <div class="d-flex">
      <h3 class="card-title">
      {{ integration.name }}
      </h3>
      {% if active %}
        <div style="color: green; margin-left: 11px; margin-top: 3px;">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-circle-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
             <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
             <circle cx="12" cy="12" r="9"></circle>
             <path d="M9 12l2 2l4 -4"></path>
          </svg>
        </div>
      {% endif %}
    </div>
    <div class="d-flex">
      <div class="dropup">
        <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown" aria-label="Open condition options">
         <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-dots-vertical" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#009988" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <circle cx="12" cy="12" r="1" />
            <circle cx="12" cy="19" r="1" />
            <circle cx="12" cy="5" r="1" />
          </svg>
        </a>
        <div class="dropdown-menu dropdown-menu-end">
          {% if integration.skip_user_provisioning %}
            <form method="post" action="{% url 'people:revoke_access' user.id integration.id %}">
              {% csrf_token %}
              <button type="submit" class="btn btn-white w-100">
                {% translate "Revoke access" %}
              </button>
            </form>
          {% else %}
            <a href="{% url 'people:revoke_access' object.id integration.id %}" class="dropdown-item">{% translate "Revoke access" %}</a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  <div class="card-footer">
    {% if loading %}
    <button class="btn btn-primary w-100" disabled>
      <span class="spinner-border spinner-border-sm me-2" role="status"></span>
      {% translate "Checking status" %}
    </button>
    {% endif %}
    {% if not loading %}
      {% if active is None %}
        {% translate "Error when trying to reach service" %}
      {% elif active %}
        <button class="btn btn-primary w-100">
          {% translate "Activated" %}
        </button>
      {% else %}
        {% if integration.skip_user_provisioning %}
          <form method="post" action="{% url 'people:user_give_integration' object.id integration.id %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-white w-100">
              {% translate "Set manually activated" %}
            </button>
          </form>
        {% else %}
          <a href="{% url 'people:user_give_integration' object.id integration.id %}" class="btn btn-white w-100">
            {% translate "Give access" %}
          </a>
        {% endif %}
      {% endif %}
    {% endif %}
  </div>
</div>
